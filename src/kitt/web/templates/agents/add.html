{% extends "base.html" %}
{% block title %}KITT - Add Agent{% endblock %}

{% block content %}
<div class="space-y-6 max-w-3xl">
    <div>
        <h1 class="text-2xl font-bold">Add Agent</h1>
        <p class="text-kitt-dim text-sm mt-1">Set up a KITT agent on a GPU server</p>
    </div>

    <div class="bg-kitt-surface rounded-lg p-6 space-y-6">
        <div>
            <h2 class="text-lg font-semibold mb-3">One-line install</h2>
            <p class="text-kitt-dim text-sm mb-3">Run this on the GPU server to install and configure the agent automatically:</p>
            <div class="bg-kitt-bg rounded-md p-4 font-mono text-sm break-all">
                <code>curl -fL {{ server_url }}/api/v1/agent/install.sh | bash</code>
            </div>
            <p class="text-kitt-dim text-xs mt-2">This creates a virtual environment, downloads the agent package from this server, and configures it. The agent version always matches the server.</p>
        </div>

        <div>
            <h2 class="text-lg font-semibold mb-3">Then start the agent</h2>
            <div class="bg-kitt-bg rounded-md p-4 font-mono text-sm">
                <code>~/.kitt/agent-venv/bin/kitt-agent start</code>
            </div>
            <p class="text-kitt-dim text-xs mt-2">The agent will register with this server and begin sending heartbeats.</p>
        </div>

        <div>
            <h2 class="text-lg font-semibold mb-3">Verify</h2>
            <p class="text-kitt-dim text-sm">Once the agent starts, it will appear on the <a href="/agents" class="text-kitt-accent hover:underline">Agents page</a> within a few seconds.</p>
        </div>
    </div>

    <div class="bg-kitt-surface rounded-lg p-6">
        <h2 class="text-lg font-semibold mb-3">Alternative: Systemd service</h2>
        <p class="text-kitt-dim text-sm mb-3">For persistent agent deployment, the install script prints systemd instructions. Or manually:</p>
        <div class="bg-kitt-bg rounded-md p-4 font-mono text-sm space-y-1">
            <code>curl -fL {{ server_url }}/api/v1/agent/install.sh | bash</code><br>
            <code># Follow the systemd instructions printed at the end</code>
        </div>
    </div>

    <div class="bg-kitt-surface rounded-lg p-6">
        <h2 class="text-lg font-semibold mb-3">Manual install</h2>
        <p class="text-kitt-dim text-sm mb-3">If you prefer to install manually:</p>
        <div class="bg-kitt-bg rounded-md p-4 font-mono text-sm space-y-1">
            <code>python3 -m venv ~/.kitt/agent-venv</code><br>
            <code>curl -fL {{ server_url }}/api/v1/agent/package -o /tmp/kitt-agent.tar.gz</code><br>
            <code>~/.kitt/agent-venv/bin/pip install /tmp/kitt-agent.tar.gz</code><br>
            <code>~/.kitt/agent-venv/bin/kitt-agent init --server {{ server_url }} --token {{ auth_token or 'YOUR_TOKEN' }}</code><br>
            <code>~/.kitt/agent-venv/bin/kitt-agent start</code>
        </div>
    </div>
</div>
{% endblock %}
