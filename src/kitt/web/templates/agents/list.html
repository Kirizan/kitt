{% extends "base.html" %}
{% block title %}KITT - Agents{% endblock %}

{% block content %}
<div class="space-y-6">
    <div class="flex items-center justify-between">
        <div>
            <h1 class="text-2xl font-bold">Agents</h1>
            <p class="text-kitt-dim text-sm mt-1">Manage GPU agents for distributed benchmarking</p>
        </div>
        <a href="/agents/add" class="bg-kitt-accent hover:bg-kitt-accent/80 text-white px-4 py-2 rounded-md text-sm font-medium transition-colors">
            Add Agent
        </a>
    </div>

    {% if agents %}
    <div class="bg-kitt-surface rounded-lg overflow-hidden">
        <table class="w-full text-sm">
            <thead>
                <tr class="text-kitt-dim text-left bg-kitt-primary/50">
                    <th class="px-4 py-3 font-medium">Name</th>
                    <th class="px-4 py-3 font-medium">Host</th>
                    <th class="px-4 py-3 font-medium">Status</th>
                    <th class="px-4 py-3 font-medium">GPU</th>
                    <th class="px-4 py-3 font-medium">RAM</th>
                    <th class="px-4 py-3 font-medium">Last Heartbeat</th>
                    <th class="px-4 py-3 font-medium">Actions</th>
                </tr>
            </thead>
            <tbody class="divide-y divide-kitt-primary/20"
                   hx-get="/agents" hx-trigger="every 5s" hx-select="tbody" hx-swap="outerHTML">
                {% for agent in agents %}
                <tr class="hover:bg-kitt-bg/30">
                    <td class="px-4 py-3">
                        <a href="/agents/{{ agent.id }}" class="font-medium hover:text-kitt-accent">{{ agent.name }}</a>
                    </td>
                    <td class="px-4 py-3 text-kitt-dim">{{ agent.hostname }}:{{ agent.port }}</td>
                    <td class="px-4 py-3">
                        <span class="inline-flex items-center space-x-1.5">
                            <span class="w-2 h-2 rounded-full
                                  {% if agent.status == 'online' %}bg-green-400
                                  {% elif agent.status == 'busy' %}bg-yellow-400
                                  {% else %}bg-gray-500{% endif %}"></span>
                            <span>{{ agent.status }}</span>
                        </span>
                    </td>
                    <td class="px-4 py-3">{{ agent.gpu_info or '-' }}</td>
                    <td class="px-4 py-3">{% if agent.ram_gb %}{{ agent.ram_gb }}GB{% else %}-{% endif %}</td>
                    <td class="px-4 py-3 text-kitt-dim text-xs">{{ agent.last_heartbeat[:19] if agent.last_heartbeat else '-' }}</td>
                    <td class="px-4 py-3">
                        <a href="/agents/{{ agent.id }}" class="text-kitt-accent hover:underline text-xs">Details</a>
                    </td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>
    {% else %}
    <div class="bg-kitt-surface rounded-lg p-12 text-center">
        <p class="text-kitt-dim mb-4">No agents registered yet.</p>
        <a href="/agents/add" class="text-kitt-accent hover:underline">Set up your first agent</a>
    </div>
    {% endif %}
</div>
{% endblock %}
